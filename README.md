# CAD Quantity Pro v2.0

AutoCAD 물량 산출 자동화 프로그램 - 계층구조 테이블 버전

## 주요 기능

### 계층구조 테이블
- 대분류/중분류/항목으로 체계적인 물량 관리
- 우클릭 메뉴로 쉬운 계층 추가/삭제
- 번호 자동 생성 (1, 1-1, 1-1-1)

### CAD 객체 선택
- AutoCAD에서 직접 객체 선택 (🎯 버튼)
- 자동 수량 계산 및 치수 추출
- Line, Polyline, Circle, Block 등 모든 객체 지원

### 유사 객체 찾기
- 돋보기(🔍) 버튼으로 선택 도우미 실행
- 같은 레이어, 타입, 크기, 색상 검색
- 영역 선택으로 특정 구역만 검색

### 자동 그룹화
- Line 객체 길이별 자동 분류
- 각 그룹을 별도 행으로 자동 추가
- 사각형 자동 감지 및 가로/세로 측정

### 수식 계산
- 한글/영문 변수 지원 (수량, 가로, 세로 등)
- 실시간 자동 계산
- 복잡한 수식 지원

## 설치 방법

### 필수 요구사항
- Windows 10/11
- AutoCAD 2021 이상
- Python 3.8 이상

### 패키지 설치
```bash
pip install PyQt5 pywin32 pandas
```

### 프로그램 실행
```bash
python CAD_Quantity_Pro.py
```

## 사용법

### 1. AutoCAD 연결
1. AutoCAD 실행 및 도면 열기
2. CAD_Quantity_Pro.py 실행
3. "🔗 AutoCAD 연결" 버튼 클릭

### 2. 계층구조 작업
1. 테이블에서 우클릭 → "대분류 추가"
2. 대분류 선택 후 우클릭 → "중분류 추가"
3. 중분류 선택 후 우클릭 → "항목 추가"

### 3. 물량 산출
1. 항목 행에서 🎯 버튼 클릭
2. AutoCAD에서 객체 선택
3. 자동으로 수량과 치수 입력됨

### 4. 유사 객체 찾기
1. 🔍 버튼 클릭하여 선택 도우미 열기
2. 찾기 옵션 설정 (레이어, 타입, 크기 등)
3. 필요시 영역 설정으로 검색 범위 제한
4. "유사 객체 찾기" 클릭

### 5. 수식 사용
- 계산식 컬럼에 수식 입력
- 예: `수량 * 가로 * 세로` 또는 `qty * width * height`
- 결과는 자동으로 계산됨

## 파일 구조

- `CAD_Quantity_Pro.py` - 메인 프로그램
- `simple_hierarchical_table.py` - 계층구조 테이블 모듈
- `.gitignore` - Git 설정 파일
- `README.md` - 이 문서

## 라이센스

Private Project
# CAD Quantity Pro v2.0 - 개발 현황 문서

## 📅 최종 업데이트: 2025-08-10

## ✅ 완료된 기능 (현재 구현 상태)

### 1. 계층구조 테이블 시스템
- ✅ 대분류/중분류/항목 3단계 계층구조
- ✅ 번호 자동 생성 (1, 1-1, 1-1-1)
- ✅ 우클릭 컨텍스트 메뉴
- ✅ 계층별 색상 구분 및 편집 제한

### 2. CAD 객체 선택 및 처리
- ✅ AutoCAD 연결 (COM API)
- ✅ 객체 직접 선택 (🎯 버튼)
- ✅ Line, Polyline, Circle, Block 등 모든 객체 지원
- ✅ 자동 수량 계산
- ✅ 사각형 자동 감지 (폴리라인 → 가로/세로 추출)

### 3. 유사 객체 찾기 (돋보기 기능)
- ✅ 선택 도우미 다이얼로그
- ✅ 같은 레이어 찾기
- ✅ 같은 타입 찾기
- ✅ 같은 크기 찾기
- ✅ 같은 색상 찾기
- ✅ 영역 선택 기능 (특정 구역만 검색)

### 4. 자동 그룹화
- ✅ Line 객체 길이별 자동 분류
- ✅ 각 그룹을 별도 행으로 자동 추가
- ✅ 규격(길이)별 수량 집계

### 5. 수식 계산 엔진
- ✅ 한글 변수 지원 (수량, 가로, 세로, 면적, 둘레, 두께, 층고)
- ✅ 영문 변수 지원 (qty, width, height, area, perimeter, thickness, floor)
- ✅ 실시간 자동 계산
- ✅ 결과 컬럼 편집 불가 처리

### 6. 버그 수정 완료
- ✅ 콘솔창 복원
- ✅ 선택 도우미 체크박스 기능
- ✅ FHD 모니터 화면 잘림 해결
- ✅ "개수" → "수량" 용어 변경
- ✅ 중복 객체 카운팅 문제 해결
- ✅ 카테고리/서브카테고리 텍스트 편집 방지
- ✅ Rectangle 값 자동 입력
- ✅ Line 길이 "가로" 컬럼 배치
- ✅ GetPoint/GetCorner 오류 수정
- ✅ 파일명 변경에 따른 import 오류 수정

## 🚧 알려진 이슈

### 1. 경미한 이슈
- PyQt5 DeprecationWarning (동작에는 영향 없음)
- 영역 선택 시 드래그 박스 미표시 (기능은 정상)

## 📋 향후 개발 계획

### Phase 1: 데이터 관리 (우선순위 높음)
- [ ] Excel 내보내기 기능
- [ ] Excel 가져오기 기능
- [ ] 프로젝트 저장/불러오기 (.json)
- [ ] 템플릿 시스템

### Phase 2: UI/UX 개선
- [ ] 다크 모드
- [ ] 단축키 지원
- [ ] 실행 취소/재실행 (Undo/Redo)
- [ ] 드래그&드롭으로 행 순서 변경

### Phase 3: 고급 기능
- [ ] 레이어별 일괄 처리
- [ ] 블록 속성 읽기
- [ ] 도면 배치(Layout) 지원
- [ ] 3D 객체 체적 계산
- [ ] 철근 중량 자동 계산

### Phase 4: 성능 최적화
- [ ] 대용량 도면 처리 최적화
- [ ] 백그라운드 처리
- [ ] 진행률 표시

## 🔧 기술 스택

- **언어**: Python 3.9+
- **GUI**: PyQt5
- **CAD 연동**: pywin32 (COM API)
- **데이터 처리**: pandas
- **파일 구조**:
  - `CAD_Quantity_Pro.py` - 메인 프로그램
  - `simple_hierarchical_table.py` - 계층구조 테이블 모듈

## 📝 개발 노트

### 주요 설계 결정
1. **평면 테이블 제거**: 복잡도 감소를 위해 계층구조 테이블만 유지
2. **Simple 버전 채택**: 과도한 기능보다 안정성 우선
3. **모듈 분리**: 테이블 로직을 별도 파일로 분리하여 유지보수성 향상

### 코드 컨벤션
- 한글 주석 사용 (명확한 의도 전달)
- 클래스명: PascalCase
- 함수명: snake_case
- 상수: UPPER_CASE

## 🐛 디버깅 팁

### AutoCAD 연결 실패 시
1. AutoCAD를 관리자 권한으로 실행
2. 도면이 열려있는지 확인
3. COM 캐시 정리: `clear_com_cache.py` 실행

### 객체 선택 안 될 때
1. 레이어 잠금 확인
2. 객체가 블록 내부에 있는지 확인
3. 도면 재생성 (REGEN 명령)

## 📞 문의

개발 관련 문의사항이나 버그 리포트는 GitHub Issues에 등록해주세요.
https://github.com/yangkyungsuk/cadpro/issues